$$
\begin{aligned}
a &\gets b q + a q + a p \\
b &\gets b p + a q
\end{aligned}
$$

$$
\begin{aligned}
a' &= b q + a q + a p \\
b' &= b p + a q \\
a'' &= b' q + a' q + a' p \\
    &= (b p + a q) q + (b q + a q + a p) q + (b q + a q + a p) p \\
    &= b p q + a q^2 + b q^2 + a q^2 + a p q + b p q + a p q + a p^2 \\
    &= (p^2 + 2 q^2 + 2 p q)a + (q^2+2 p q)b \\
    &= b(q^2 + 2 p q) + a(q^2 + 2 p q) + a(p^2 + q^2) \\
b'' &= b'p + a'q \\
    &= (b p + a q)p + (b q + a q + a p)q \\
    &= b p^2 + a p q + b q^2 + a q^2 + a p q \\
    &= (q^2 + 2 p q)a + (p ^ 2 + q^2)b \\
    &= b(p^2 + q^2) + a(q^2 + 2p q)
\end{aligned}
$$

$$
\begin{aligned}
p' &= p^2 + q^2 \\
q' &= q^2 + 2 p q
\end{aligned}
$$
